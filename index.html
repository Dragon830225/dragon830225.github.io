<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Außer-Haus App</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>
  <style>
    body { font-family: sans-serif; padding: 1em; max-width: 600px; margin: auto; }
    input, button, select { margin: 5px 0; padding: 0.5em; width: 100%; }
    .admin { background: #f3f3f3; padding: 1em; margin-top: 1em; border-radius: 8px; }
    .kunde { border-bottom: 1px solid #ccc; padding: 0.5em 0; }
  </style>
</head>
<body>
  <h2>Außer-Haus Kundenübersicht</h2>
  <div id="kundenListe"></div>

  <div class="admin">
    <h3>Admin Login</h3>
    <input type="password" id="adminPasswort" placeholder="Passwort eingeben">
    <button onclick="login()">Login</button>
    
    <div id="adminFormular" style="display:none">
      <h4>Neuen Kunden hinzufügen</h4>
      <input type="text" id="name" placeholder="Name">
      <input type="text" id="strasse" placeholder="Straße">
      <input type="text" id="ort" placeholder="Ort">
      <button onclick="hinzufuegen()">Speichern</button>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAJcjqAjlyrbiojweyXFOLMrelTsHSFog0",
      authDomain: "ausser-haus.firebaseapp.com",
      databaseURL: "https://ausser-haus-default-rtdb.firebaseio.com",
      projectId: "ausser-haus",
      storageBucket: "ausser-haus.firebasestorage.app",
      messagingSenderId: "919348966579",
      appId: "1:919348966579:web:8cdbe342868eb6013eecc6"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const kundenListe = document.getElementById("kundenListe");

    function ladeKunden() {
      db.ref("kunden").on("value", (snapshot) => {
        kundenListe.innerHTML = "";
        snapshot.forEach((kind) => {
          const k = kind.val();
          const div = document.createElement("div");
          div.className = "kunde";
          div.innerText = `${k.name}, ${k.strasse}, ${k.ort}`;
          kundenListe.appendChild(div);
        });
      });
    }

    ladeKunden();

    function login() {
      const pw = document.getElementById("adminPasswort").value;
      if (pw === "1234") {
        document.getElementById("adminFormular").style.display = "block";
      } else {
        alert("Falsches Passwort");
      }
    }

    function hinzufuegen() {
      const name = document.getElementById("name").value;
      const strasse = document.getElementById("strasse").value;
      const ort = document.getElementById("ort").value;
      if (!name || !strasse || !ort) return alert("Bitte alle Felder ausfüllen");
      const neuerKunde = { name, strasse, ort };
      const neuerKey = db.ref("kunden").push().key;
      db.ref("kunden/" + neuerKey).set(neuerKunde);
      document.getElementById("name").value = "";
      document.getElementById("strasse").value = "";
      document.getElementById("ort").value = "";
    }
  </script>
</body>
</html>
